exports.id=914,exports.ids=[914],exports.modules={333:(e,t,r)=>{"use strict";r.d(t,{dj:()=>f});var o=r(3210);let s=0,n=new Map,a=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},5e3);n.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?a(r):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],u={toasts:[]};function d(e){u=i(u,e),l.forEach(e=>{e(u)})}function c({...e}){let t=(s=(s+1)%Number.MAX_VALUE).toString(),r=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function f(){let[e,t]=(0,o.useState)(u);return{...e,toast:c,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},1088:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6346,23)),Promise.resolve().then(r.t.bind(r,7924,23)),Promise.resolve().then(r.t.bind(r,5656,23)),Promise.resolve().then(r.t.bind(r,99,23)),Promise.resolve().then(r.t.bind(r,8243,23)),Promise.resolve().then(r.t.bind(r,8827,23)),Promise.resolve().then(r.t.bind(r,2763,23)),Promise.resolve().then(r.t.bind(r,7173,23))},1360:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6444,23)),Promise.resolve().then(r.t.bind(r,6042,23)),Promise.resolve().then(r.t.bind(r,8170,23)),Promise.resolve().then(r.t.bind(r,9477,23)),Promise.resolve().then(r.t.bind(r,9345,23)),Promise.resolve().then(r.t.bind(r,2089,23)),Promise.resolve().then(r.t.bind(r,6577,23)),Promise.resolve().then(r.t.bind(r,1307,23))},2358:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>o});let o=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call Toaster() from the server but Toaster is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jash/Desktop/Dal/Term2/Cloud/Project/frontend/components/ui/toaster.tsx","Toaster")},2386:(e,t,r)=>{Promise.resolve().then(r.bind(r,3066)),Promise.resolve().then(r.bind(r,2358)),Promise.resolve().then(r.bind(r,8168))},2704:()=>{},2892:(e,t,r)=>{"use strict";r.d(t,{ThemeProvider:()=>n});var o=r(687);r(3210);var s=r(218);function n({children:e,...t}){return(0,o.jsx)(s.N,{...t,children:e})}},3066:(e,t,r)=>{"use strict";r.d(t,{ThemeProvider:()=>o});let o=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call ThemeProvider() from the server but ThemeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jash/Desktop/Dal/Term2/Cloud/Project/frontend/components/theme-provider.tsx","ThemeProvider")},3270:(e,t,r)=>{"use strict";r.d(t,{A:()=>d,AuthProvider:()=>u});var o=r(687),s=r(3210),n=r(6189),a=r(9556),i=r(333);let l=(0,s.createContext)(void 0);function u({children:e}){let[t,r]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),[c,f]=(0,s.useState)(null),h=(0,n.useRouter)(),{toast:p}=(0,i.dj)(),m=async()=>{console.log("Auth: Refreshing user data"),f(null);try{console.log("Auth: No token found during refresh"),r(null);return}catch(e){console.error("Auth: Error refreshing user data:",e),f(e.message||"Failed to authenticate user"),500===e.status?(console.warn("Auth: Backend server error (500), keeping token for retry"),p({variant:"destructive",title:"Server error",description:"The server encountered an error. Please try again later."})):(r(null),p({variant:"destructive",title:"Authentication error",description:e.message||"Failed to authenticate user."}))}},v=async(e,t)=>{console.log("Auth: Login attempt"),f(null);try{let r=await (0,a.iD)(e,t);return console.log("Auth: Login successful, token received"),r.token,p({title:"Login successful",description:"Welcome back to DocuShare!",variant:"default"}),r}catch(e){throw console.error("Auth: Login error:",e),f(e.message||"Login failed"),p({variant:"destructive",title:"Login failed",description:e.message||"Invalid email or password."}),e}},g=async(e,t)=>{console.log("Auth: Register attempt"),f(null);try{let r=await (0,a.kz)(e,t);return console.log("Auth: Registration successful, token received"),r.token,p({title:"Registration successful",description:"Your account has been created successfully.",variant:"default"}),r}catch(e){throw console.error("Auth: Registration error:",e),f(e.message||"Registration failed"),p({variant:"destructive",title:"Registration failed",description:e.message||"There was a problem creating your account."}),e}};return(0,o.jsx)(l.Provider,{value:{user:t,isLoading:u,isAuthenticated:!!t,login:v,register:g,logout:()=>{console.log("Auth: Logging out, clearing token"),f(null),(0,a.ri)(),r(null),p({title:"Logged out",description:"You have been logged out successfully.",variant:"default"}),h.push("/")},refreshUser:m,authError:c},children:e})}function d(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5946:(e,t,r)=>{Promise.resolve().then(r.bind(r,2892)),Promise.resolve().then(r.bind(r,9794)),Promise.resolve().then(r.bind(r,3270))},6241:(e,t,r)=>{"use strict";r.d(t,{Yq:()=>i,cn:()=>n,z3:()=>a});var o=r(9384),s=r(2348);function n(...e){return(0,s.QP)((0,o.$)(e))}function a(e,t=2){if(0===e)return"0 Bytes";let r=Math.floor(Math.log(e)/Math.log(1024));return Number.parseFloat((e/Math.pow(1024,r)).toFixed(t<0?0:t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}function i(e){if(!e)return"N/A";let t=new Date(e);return isNaN(t.getTime())?"Invalid date":new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}},8014:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d,metadata:()=>u});var o=r(7413),s=r(9258),n=r.n(s),a=r(2358),i=r(3066),l=r(8168);r(2704);let u={title:"DocuShare - Secure File Sharing",description:"Share your files securely with password protection, expiry dates, and download limits",generator:"v0.dev"};function d({children:e}){return(0,o.jsx)("html",{lang:"en",suppressHydrationWarning:!0,children:(0,o.jsx)("body",{className:n().className,children:(0,o.jsx)(i.ThemeProvider,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:(0,o.jsxs)(l.AuthProvider,{children:[e,(0,o.jsx)(a.Toaster,{})]})})})})}},8168:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>s});var o=r(2907);let s=(0,o.registerClientReference)(function(){throw Error("Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jash/Desktop/Dal/Term2/Cloud/Project/frontend/context/auth-context.tsx","AuthProvider");(0,o.registerClientReference)(function(){throw Error("Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jash/Desktop/Dal/Term2/Cloud/Project/frontend/context/auth-context.tsx","useAuth")},9556:(e,t,r)=>{"use strict";r.d(t,{HW:()=>u,JZ:()=>b,M2:()=>A,MW:()=>k,QM:()=>S,SV:()=>P,TK:()=>c,Uq:()=>h,Ww:()=>m,_P:()=>N,_Q:()=>w,ag:()=>g,ar:()=>E,d:()=>v,ge:()=>T,hG:()=>f,iD:()=>l,jX:()=>j,kz:()=>i,oE:()=>x,ri:()=>d,s$:()=>y,y_:()=>p});let o="http://18.226.28.25:3001/api",s=()=>null,n=e=>!!e&&/^[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.[A-Za-z0-9-_.+/=]*$/.test(e);async function a(e,t={}){let r=s(),i=n(r)?r:null;r&&!i&&console.warn("API: Invalid token format detected, clearing token");let l={"Content-Type":"application/json",...i?{Authorization:`Bearer ${i}`}:{},...t.headers||{}};console.log(`API: Making request to ${e} with token: ${i?"Present":"Not present"}`);try{let s=await fetch(`${o}${e}`,{...t,headers:l});if(!s.ok){let t;let o=await s.text();try{t=JSON.parse(o)}catch(e){t={message:o||`API request failed with status ${s.status}`}}console.error(`API: Error for ${e}:`,s.status,t),401===s.status&&r&&console.warn("API: Received 401 with token present, clearing invalid token");let n=Error(t.message||`API request failed with status ${s.status}`);throw n.status=s.status,n}return s.json()}catch(t){throw console.error(`API: Request error for ${e}:`,t),t}}async function i(e,t){let r=await a("/auth/register",{method:"POST",body:JSON.stringify({email:e,password:t})});return r.token&&sessionStorage.setItem("token",r.token),r}async function l(e,t){let r=await a("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});return r.token&&sessionStorage.setItem("token",r.token),r}async function u(){return a("/auth/me")}async function d(){return sessionStorage.removeItem("token"),Promise.resolve()}async function c(e){return a("/users",{method:"PUT",body:JSON.stringify(e)})}async function f(){return a("/users",{method:"DELETE"})}async function h(){return a("/files")}async function p(e){return a(`/files/${e}/download-url`)}async function m(e){return a(`/files/${e}`,{method:"DELETE"})}async function v(e){return a("/links",{method:"POST",body:JSON.stringify(e)})}async function g(){return a("/links")}async function y(e,t){return a(`/links/${e}`,{method:"PUT",body:JSON.stringify(t)})}async function b(e){return a(`/links/${e}/revoke`,{method:"POST"})}async function w(e){return a(`/links/${e}/activate`,{method:"POST"})}async function P(e){return a(`/links/${e}`,{method:"DELETE"})}async function x(){return a("/subscription/plan")}async function T(e){return a("/subscription/upgrade",{method:"POST",body:JSON.stringify({planId:e})})}async function A(){return a("/subscription/cancel",{method:"POST"})}async function S(e,t){let r=s(),n=new FormData;return n.append("file",e),new Promise((e,s)=>{let a=new XMLHttpRequest;a.open("POST",`${o}/files/upload`),r&&a.setRequestHeader("Authorization",`Bearer ${r}`),a.upload.addEventListener("progress",e=>{e.lengthComputable&&t&&t(Math.round(e.loaded/e.total*100))}),a.onload=()=>{if(a.status>=200&&a.status<300)try{let t=JSON.parse(a.responseText);e(t)}catch(e){s(Error("Invalid response format"))}else{let e="Upload failed";try{e=JSON.parse(a.responseText).message||e}catch(t){e=a.statusText||e}413===a.status?e="File is too large. Maximum size is 100MB.":400===a.status&&(e="No file was provided for upload."),s(Error(e))}},a.onerror=()=>{s(Error("Network error occurred during upload"))},a.send(n)})}async function k(e){try{let t=await fetch(`${o}/public/links/${e}`);if(!t.ok){let e=await t.text(),r=`Failed to get link info: ${t.status}`;try{r=JSON.parse(e).message||r}catch(t){e&&(r=e)}let o=Error(r);throw o.status=t.status,o}return t.json()}catch(e){throw console.error("Request error for link info:",e),e}}async function N(e,t){console.log(`Getting file content for link ${e}, password provided: ${t?"Yes":"No"}`);let r=t?"POST":"GET",s=t?JSON.stringify({password:t}):void 0;try{console.log(`Making ${r} request to get file content, with password: ${t?"Yes":"No"}`);let n=await fetch(`${o}/public/links/${e}/content`,{method:r,headers:{"Content-Type":"application/json"},body:s});if(!n.ok){let e=await n.text(),t=`Failed to get file content: ${n.status}`;try{t=JSON.parse(e).message||t}catch(r){e&&(t=e)}401===n.status?t="Password required":404===n.status?t="File not found. It may have been deleted or moved.":403===n.status?t="You don't have permission to access this file.":n.status>=500&&(t="Server error. Please try again later."),console.error("API error for file content:",n.status,t);let r=Error(t);throw r.status=n.status,r}let a=await n.json();if(!a.viewUrl&&!a.fileUrl)throw Error("Invalid response: Missing file URL");return a.viewUrl&&!a.fileUrl&&(a.fileUrl=a.viewUrl),a}catch(e){throw console.error("Request error for file content:",e),e}}async function j(e,t){return fetch(`${o}/public/links/${e}/verify-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t})}).then(async e=>{if(!e.ok){if(401===e.status)return{success:!1};throw Error(`Failed to verify password: ${e.status}`)}return await e.json()})}async function E(e){let t=new URLSearchParams;e?.linkId&&t.append("linkId",e.linkId),e?.action&&t.append("action",e.action),e?.startDate&&t.append("startDate",e.startDate),e?.endDate&&t.append("endDate",e.endDate);let r=t.toString(),o=`/access/logs${r?`?${r}`:""}`;try{let e=await a(o);if(!e.logs&&Array.isArray(e))return{logs:e};return e}catch(e){throw console.error("Error fetching access logs:",e),e}}},9794:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>g});var o=r(687),s=r(3210),n=r(7313),a=r(4224),i=r(1860),l=r(6241);let u=n.Kq,d=s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(n.LM,{ref:r,className:(0,l.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));d.displayName=n.LM.displayName;let c=(0,a.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),f=s.forwardRef(({className:e,variant:t,...r},s)=>(0,o.jsx)(n.bL,{ref:s,className:(0,l.cn)(c({variant:t}),e),...r}));f.displayName=n.bL.displayName,s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(n.rc,{ref:r,className:(0,l.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t})).displayName=n.rc.displayName;let h=s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(n.bm,{ref:r,className:(0,l.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:(0,o.jsx)(i.A,{className:"h-4 w-4"})}));h.displayName=n.bm.displayName;let p=s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(n.hE,{ref:r,className:(0,l.cn)("text-sm font-semibold",e),...t}));p.displayName=n.hE.displayName;let m=s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(n.VY,{ref:r,className:(0,l.cn)("text-sm opacity-90",e),...t}));m.displayName=n.VY.displayName;var v=r(333);function g(){let{toasts:e}=(0,v.dj)();return(0,o.jsxs)(u,{children:[e.map(({id:e,title:t,description:r,action:s,...n})=>(0,o.jsxs)(f,{...n,children:[(0,o.jsxs)("div",{className:"grid gap-1",children:[t&&(0,o.jsx)(p,{children:t}),r&&(0,o.jsx)(m,{children:r})]}),s,(0,o.jsx)(h,{})]},e)),(0,o.jsx)(d,{})]})}}};