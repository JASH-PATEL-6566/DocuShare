"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{6185:(e,i,n)=>{n.d(i,{d:()=>S});var r=n(5155),s=n(2115),l=n(3999),t=n(7168),a=n(4503),d=n(1886),o=n(7133),c=n(5594),h=n(2177),x=n(221),u=n(9840),m=n(9540),j=n(9852),p=n(88),v=n(5784);let w=c.z.object({expiryIn:c.z.string(),password:c.z.string().optional(),downloadLimit:c.z.coerce.number().int().min(0).optional(),viewLimit:c.z.coerce.number().int().min(0).optional(),allowDownload:c.z.boolean().default(!0),requireIdentification:c.z.boolean().default(!1)});function f(e){let{link:i,open:n,onOpenChange:l,onLinkUpdated:o}=e,{toast:c}=(0,a.dj)(),[f,y]=(0,s.useState)(!1),b=(0,h.mN)({resolver:(0,x.u)(w),defaultValues:{expiryIn:(()=>{let e=new Date,n=Math.ceil((new Date(i.expiryTimestamp).getTime()-e.getTime())/864e5);return n<=1?"24h":n<=3?"3d":n<=7?"7d":n<=14?"14d":"30d"})(),password:"",downloadLimit:i.downloadLimit||0,viewLimit:i.viewLimit||0,allowDownload:i.allowDownload,requireIdentification:i.requireIdentification}});async function k(e){y(!0);try{let n=await (0,d.s$)(i.linkId,{expiryIn:e.expiryIn,password:e.password||void 0,downloadLimit:e.downloadLimit||void 0,viewLimit:e.viewLimit||void 0,allowDownload:e.allowDownload,requireIdentification:e.requireIdentification});o(n),c({title:"Link updated",description:"Your file link has been updated successfully."})}catch(e){console.error("Error updating link:",e),c({variant:"destructive",title:"Update failed",description:"There was a problem updating your link."})}finally{y(!1)}}return(0,r.jsx)(u.lG,{open:n,onOpenChange:l,children:(0,r.jsxs)(u.Cf,{children:[(0,r.jsxs)(u.c7,{children:[(0,r.jsx)(u.L3,{children:"Edit Sharing Link"}),(0,r.jsx)(u.rr,{children:"Update your file sharing link settings"})]}),(0,r.jsx)(m.lV,{...b,children:(0,r.jsxs)("form",{onSubmit:b.handleSubmit(k),className:"space-y-4",children:[(0,r.jsx)(m.zB,{control:b.control,name:"expiryIn",render:e=>{let{field:i}=e;return(0,r.jsxs)(m.eI,{children:[(0,r.jsx)(m.lR,{children:"Expiry Time"}),(0,r.jsxs)(v.l6,{onValueChange:i.onChange,defaultValue:i.value,disabled:f,children:[(0,r.jsx)(m.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{placeholder:"Select expiry time"})})}),(0,r.jsxs)(v.gC,{children:[(0,r.jsx)(v.eb,{value:"1h",children:"1 hour"}),(0,r.jsx)(v.eb,{value:"24h",children:"24 hours"}),(0,r.jsx)(v.eb,{value:"3d",children:"3 days"}),(0,r.jsx)(v.eb,{value:"7d",children:"7 days"}),(0,r.jsx)(v.eb,{value:"14d",children:"14 days"}),(0,r.jsx)(v.eb,{value:"30d",children:"30 days"})]})]}),(0,r.jsx)(m.Rr,{children:"When the link will expire"}),(0,r.jsx)(m.C5,{})]})}}),(0,r.jsx)(m.zB,{control:b.control,name:"password",render:e=>{let{field:n}=e;return(0,r.jsxs)(m.eI,{children:[(0,r.jsxs)(m.lR,{children:["Password ",i.hasPassword?"(Change)":"(Optional)"]}),(0,r.jsx)(m.MJ,{children:(0,r.jsx)(j.p,{type:"password",placeholder:i.hasPassword?"Enter new password":"Leave empty for no password",disabled:f,...n})}),(0,r.jsx)(m.Rr,{children:i.hasPassword?"Leave empty to keep current password":"Add password protection to your link"}),(0,r.jsx)(m.C5,{})]})}}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(m.zB,{control:b.control,name:"downloadLimit",render:e=>{let{field:i}=e;return(0,r.jsxs)(m.eI,{children:[(0,r.jsx)(m.lR,{children:"Download Limit"}),(0,r.jsx)(m.MJ,{children:(0,r.jsx)(j.p,{type:"number",min:"0",placeholder:"0 for unlimited",disabled:f,...i})}),(0,r.jsx)(m.Rr,{children:"Maximum downloads allowed"}),(0,r.jsx)(m.C5,{})]})}}),(0,r.jsx)(m.zB,{control:b.control,name:"viewLimit",render:e=>{let{field:i}=e;return(0,r.jsxs)(m.eI,{children:[(0,r.jsx)(m.lR,{children:"View Limit"}),(0,r.jsx)(m.MJ,{children:(0,r.jsx)(j.p,{type:"number",min:"0",placeholder:"0 for unlimited",disabled:f,...i})}),(0,r.jsx)(m.Rr,{children:"Maximum views allowed"}),(0,r.jsx)(m.C5,{})]})}})]}),(0,r.jsx)(m.zB,{control:b.control,name:"allowDownload",render:e=>{let{field:i}=e;return(0,r.jsxs)(m.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-3",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(m.lR,{children:"Allow Download"}),(0,r.jsx)(m.Rr,{children:"Allow recipients to download the file"})]}),(0,r.jsx)(m.MJ,{children:(0,r.jsx)(p.d,{checked:i.value,onCheckedChange:i.onChange,disabled:f})})]})}}),(0,r.jsx)(m.zB,{control:b.control,name:"requireIdentification",render:e=>{let{field:i}=e;return(0,r.jsxs)(m.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-3",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(m.lR,{children:"Require Identification"}),(0,r.jsx)(m.Rr,{children:"Require recipients to identify themselves"})]}),(0,r.jsx)(m.MJ,{children:(0,r.jsx)(p.d,{checked:i.value,onCheckedChange:i.onChange,disabled:f})})]})}}),(0,r.jsxs)(u.Es,{children:[(0,r.jsx)(t.$,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:f,children:"Cancel"}),(0,r.jsx)(t.$,{type:"submit",disabled:f,children:f?"Updating...":"Update Link"})]})]})})]})})}var y=n(8524),b=n(8164),k=n(4357),g=n(646),N=n(4861),C=n(2919),L=n(1788),I=n(2657),A=n(5623),E=n(3717),R=n(2178),z=n(5690),D=n(4126),T=n(8145);function S(e){let{links:i,onDelete:n,onUpdate:c}=e,{toast:h}=(0,a.dj)(),[x,u]=(0,s.useState)({}),[m,j]=(0,s.useState)(null),[p,v]=(0,s.useState)(!1),w=async e=>{try{var i,n;let r=window.location.origin,s=e.split("/").pop(),l="".concat(r,"/view/").concat(s);if(console.log(l),null===(n=navigator)||void 0===n?void 0:null===(i=n.clipboard)||void 0===i?void 0:i.writeText)await navigator.clipboard.writeText(l),h({title:"Link copied",description:"The link has been copied to your clipboard.",variant:"default"});else throw Error("Clipboard API is not available.")}catch(e){console.error("Failed to copy link:",e),h({title:"Copy failed",description:"Could not copy the link to clipboard.",variant:"destructive"})}},S=async e=>{u(i=>({...i,[e]:!0}));try{await (0,d.SV)(e),n(e),h({title:"Link deleted",description:"Your link has been deleted successfully.",variant:"default"})}catch(e){console.error("Error deleting link:",e),h({variant:"destructive",title:"Deletion failed",description:"There was a problem deleting your link."})}finally{u(i=>({...i,[e]:!1}))}},q=async e=>{u(i=>({...i,[e]:!0}));try{await (0,d.JZ)(e);let n=i.find(i=>i.linkId===e);if(n){let e={...n,status:"revoked"};c(e)}h({title:"Link Deactivated",description:"Access to this link has been disabled.",variant:"default"})}catch(e){console.error("Error revoking link:",e),h({variant:"destructive",title:"Revocation failed",description:"There was a problem revoking your link."})}finally{u(i=>({...i,[e]:!1}))}},_=async e=>{u(i=>({...i,[e]:!0}));try{await (0,d._Q)(e);let n=i.find(i=>i.linkId===e);if(n){let e={...n,status:"active"};c(e)}h({title:"Link activated",description:"Your link has been activated successfully.",variant:"default"})}catch(e){console.error("Error activating link:",e),h({variant:"destructive",title:"Activation failed",description:"There was a problem activating your link."})}finally{u(i=>({...i,[e]:!1}))}},M=e=>{j(e),v(!0)};return 0===i.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-lg border border-dashed p-8 text-center",children:[(0,r.jsx)(b.A,{className:"h-10 w-10 text-muted-foreground"}),(0,r.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No links found"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Create links to share your files."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"rounded-md border",children:(0,r.jsxs)(y.XI,{children:[(0,r.jsx)(y.A0,{children:(0,r.jsxs)(y.Hj,{children:[(0,r.jsx)(y.nd,{children:"Link"}),(0,r.jsx)(y.nd,{children:"Expiry"}),(0,r.jsx)(y.nd,{children:"Status"}),(0,r.jsx)(y.nd,{children:"Security"}),(0,r.jsx)(y.nd,{className:"w-[100px]",children:"Actions"})]})}),(0,r.jsx)(y.BF,{children:i.map(e=>{let i=new Date(e.expiryTimestamp)<new Date,n=i?"expired":e.status;return(0,r.jsxs)(y.Hj,{children:[(0,r.jsx)(y.nA,{className:"font-medium",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(t.$,{variant:"ghost",size:"icon",onClick:()=>w(e.shareableLink),children:[(0,r.jsx)(k.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Copy link"})]}),(0,r.jsx)("span",{className:"truncate max-w-[200px]",children:e.shareableLink})]})}),(0,r.jsx)(y.nA,{children:(0,l.Yq)(e.expiryTimestamp)}),(0,r.jsx)(y.nA,{children:(0,r.jsxs)(T.E,{variant:"active"===n?"default":"revoked"===n?"destructive":"secondary",children:["active"===n&&(0,r.jsx)(g.A,{className:"mr-1 h-3 w-3"}),"revoked"===n&&(0,r.jsx)(N.A,{className:"mr-1 h-3 w-3"}),"expired"===n&&(0,r.jsx)(N.A,{className:"mr-1 h-3 w-3"}),n.charAt(0).toUpperCase()+n.slice(1)]})}),(0,r.jsx)(y.nA,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.hasPassword&&(0,r.jsxs)(T.E,{variant:"outline",children:[(0,r.jsx)(C.A,{className:"mr-1 h-3 w-3"}),"Password"]}),e.downloadLimit>0&&(0,r.jsxs)(T.E,{variant:"outline",children:[(0,r.jsx)(L.A,{className:"mr-1 h-3 w-3"}),e.downloadLimit]}),e.viewLimit>0&&(0,r.jsxs)(T.E,{variant:"outline",children:[(0,r.jsx)(I.A,{className:"mr-1 h-3 w-3"}),e.viewLimit]})]})}),(0,r.jsx)(y.nA,{children:(0,r.jsxs)(o.rI,{children:[(0,r.jsx)(o.ty,{asChild:!0,children:(0,r.jsxs)(t.$,{variant:"ghost",size:"icon",children:[(0,r.jsx)(A.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Actions"})]})}),(0,r.jsxs)(o.SQ,{align:"end",children:[(0,r.jsxs)(o._2,{onClick:()=>w(e.shareableLink),children:[(0,r.jsx)(k.A,{className:"mr-2 h-4 w-4"}),"Copy Link"]}),(0,r.jsxs)(o._2,{onClick:()=>M(e),children:[(0,r.jsx)(E.A,{className:"mr-2 h-4 w-4"}),"Edit"]}),"active"===e.status?(0,r.jsxs)(o._2,{onClick:()=>q(e.linkId),disabled:x[e.linkId],children:[(0,r.jsx)(R.A,{className:"mr-2 h-4 w-4"}),"Revoke"]}):(0,r.jsxs)(o._2,{onClick:()=>_(e.linkId),disabled:x[e.linkId]||i,children:[(0,r.jsx)(z.A,{className:"mr-2 h-4 w-4"}),"Activate"]}),(0,r.jsxs)(o._2,{onClick:()=>S(e.linkId),disabled:x[e.linkId],className:"text-destructive focus:text-destructive",children:[(0,r.jsx)(D.A,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.linkId)})})]})}),m&&(0,r.jsx)(f,{link:m,open:p,onOpenChange:v,onLinkUpdated:e=>{c(e),v(!1),j(null)}})]})}},8145:(e,i,n)=>{n.d(i,{E:()=>a});var r=n(5155);n(2115);var s=n(2085),l=n(3999);let t=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function a(e){let{className:i,variant:n,...s}=e;return(0,r.jsx)("div",{className:(0,l.cn)(t({variant:n}),i),...s})}}}]);